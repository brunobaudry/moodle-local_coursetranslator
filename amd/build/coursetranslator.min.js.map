{"version":3,"file":"coursetranslator.min.js","sources":["../src/coursetranslator.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @module     local_coursetranslator/coursetranslator\n * @copyright  2022 Kaleb Heitzman <kaleb@jamfire.io>\n * @copyright  2024 Bruno Baudry <bruno.baudry@bfh.ch>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n// Import libs\nimport ajax from \"core/ajax\";\nimport Selectors from \"./selectors\";\nimport Modal from 'core/modal';\n// Initialize the temporary translations dictionary @todo make external class\nlet tempTranslations = {};\nlet mainEditorType = '';\nlet config = {};\nlet autotranslateButton = {};\nlet checkboxes = [];\nlet sourceLang = \"\";\nlet targetLang = \"\";\nlet saveAllBtn = {};\nlet usage = {};\n\nconst registerEventListeners = () => {\n\n    document.addEventListener('change', e => {\n        if (e.target.closest(Selectors.actions.targetSwitcher)) {\n            switchTarget(e);\n        }\n        if (e.target.closest(Selectors.actions.sourceSwitcher)) {\n            switchSource(e);\n        }\n        if (e.target.closest(Selectors.actions.showUpdated)) {\n            showRows(Selectors.statuses.updated, e.target.checked);\n        }\n        if (e.target.closest(Selectors.actions.showNeedUpdate)) {\n            showRows(Selectors.statuses.needsupdate, e.target.checked);\n        }\n        if (e.target.closest(Selectors.actions.checkBoxes)) {\n            onItemChecked(e);\n        }\n    });\n    document.addEventListener('click', e => {\n        if (e.target.closest(Selectors.actions.toggleMultilang)) {\n            onToggleMultilang(e.target.closest(Selectors.actions.toggleMultilang));\n        }\n        if (e.target.closest(Selectors.actions.autoTranslateBtn)) {\n            if (config.currentlang === config.lang || config.lang === undefined) {\n                Modal.create({\n                    title: 'Cannot call deepl',\n                    body: `<p>Both languges are the same {$config.lang}</p>`,\n                    show: true,\n                    removeOnClose: true,\n                });\n            } else {\n                doAutotranslate();\n            }\n        }\n        if (e.target.closest(Selectors.actions.selectAllBtn)) {\n            toggleAllCheckboxes(e);\n        }\n        if (e.target.closest(Selectors.actions.saveAll)) {\n            const selected = document.querySelectorAll(Selectors.statuses.checkedCheckBoxes);\n            selected.forEach((e) => {\n                const key = e.dataset.key;\n                if (tempTranslations[key].translation !== \"\") {\n                    saveTranslation(key);\n                } else {\n                    window.console.warn(\"not translated \" + key);\n                }\n            });\n        }\n    });\n\n};\nconst registerUI = () => {\n    try {\n        saveAllBtn = document.querySelector(Selectors.actions.saveAll);\n        sourceLang = document.querySelector(Selectors.actions.sourceSwitcher).value;\n        targetLang = document.querySelector(Selectors.actions.targetSwitcher).value;\n        autotranslateButton = document.querySelector(Selectors.actions.autoTranslateBtn);\n        checkboxes = document.querySelectorAll(Selectors.actions.checkBoxes);\n        // Initialise status object.\n        checkboxes.forEach((node) => (tempTranslations[node.dataset.key] = {}));\n    } catch (e) {\n        if (config.debug) {\n            window.console.error(e.message);\n        }\n    }\n};\n/**\n * Translation Editor UI\n * @param {Object} cfg JS Config\n */\nexport const init = (cfg) => {\n    config = cfg;\n    usage = config.usage;\n    if (config.debug > 0) {\n        window.console.info(\"debugging coursetranslator\");\n        window.console.info(config);\n        window.console.info(usage);\n    }\n    mainEditorType = config.userPrefs;\n    // Setup\n    registerUI();\n    registerEventListeners();\n    toggleAutotranslateButton();\n    const selectAllBtn = document.querySelector(Selectors.actions.selectAllBtn);\n    selectAllBtn.disabled = sourceLang === targetLang;\n    /**\n     * Validaate translation ck\n     */\n    const validators = document.querySelectorAll(Selectors.actions.validatorsBtns);\n    validators.forEach((item) => {\n        // Get the stored data and do the saving from editors content\n        item.addEventListener('click', (e) => {\n            const _this = e.target.closest(Selectors.actions.validatorsBtns);\n            let key = _this.dataset.keyValidator;\n            if (tempTranslations[key] === null || tempTranslations[key] === undefined) {\n                /**\n                 * @todo do a UI feedback (disable save )\n                 */\n                window.console.warn(`Transaltion key \"${key}\" is undefined `,);\n            } else {\n                saveTranslation(key);\n            }\n        });\n    });\n    /**\n     * Selection Checkboxes\n     */\n    checkboxes.forEach((e) => {\n        e.disabled = sourceLang === targetLang;\n        e.addEventListener(\"click\", () => {\n            toggleAutotranslateButton();\n        });\n    });\n    showRows(Selectors.statuses.updated, document.querySelector(Selectors.actions.showUpdated).checked);\n    showRows(Selectors.statuses.needsupdate, document.querySelector(Selectors.actions.showNeedUpdate).checked);\n};\n/**\n * Save Translation to Moodle\n * @param  {String} key Data Key\n */\nconst saveTranslation = (key) => {\n    // Get processing vars.\n    let editor = tempTranslations[key].editor;\n    let text = editor.innerHTML; // We keep the editors text in case translation is edited\n    let sourceText = tempTranslations[key].source;\n    let icon = document.querySelector(replaceKey(Selectors.actions.validatorBtn, key));\n    let selector = Selectors.editors.multiples.editorsWithKey.replace(\"<KEY>\", key);\n    let element = document.querySelector(selector);\n    let id = element.getAttribute(\"data-id\");\n    let tid = element.getAttribute(\"data-tid\");\n    let table = element.getAttribute(\"data-table\");\n    let field = element.getAttribute(\"data-field\");\n\n    // Get the latest field data\n    let fielddata = {};\n    fielddata.courseid = config.courseid;\n    fielddata.id = parseInt(id);\n    fielddata.table = table;\n    fielddata.field = field;\n    if (config.debug > 0) {\n        window.console.info(fielddata);\n    }\n    // Get the latest data to parse text against.\n    ajax.call([\n        {\n            methodname: \"local_coursetranslator_get_field\",\n            args: {\n                data: [fielddata],\n            },\n            done: (data) => {\n                // The latests field text so multiple translators can work at the same time\n                let fieldtext = data[0].text;\n\n                // Field text exists\n                if (data.length > 0) {\n                    // Updated hidden textarea with updatedtext\n                    let textarea = document.querySelector(\n                        Selectors.editors.multiples.textAreas\n                            .replace(\"<KEY>\", key));\n                    // Get the updated text\n                    let updatedtext = getupdatedtext(fieldtext, text, sourceText);\n\n                    // Build the data object\n                    let tdata = {};\n                    tdata.courseid = config.courseid;\n                    tdata.id = parseInt(id);\n                    tdata.tid = tid;\n                    tdata.table = table;\n                    tdata.field = field;\n                    tdata.text = updatedtext;\n                    if (config.debug > 0) {\n                        window.console.info(tdata);\n                    }\n                    // Success Message\n                    const successMessage = () => {\n                        element.classList.add(\"local-coursetranslator__success\");\n                        // Add saved indicator\n                        setIconStatus(icon, Selectors.statuses.success);\n                        // Remove success message after a few seconds\n                        setTimeout(() => {\n                            let multilangPill = document.querySelector(replaceKey(Selectors.statuses.multilang, key));\n                            let prevTransStatus = document.querySelector(replaceKey(Selectors.statuses.prevTransStatus, key));\n                            prevTransStatus.classList = \"badge badge-pill badge-success\";\n                            if (multilangPill.classList.contains(\"invisible\")) {\n                                multilangPill.classList.remove('invisible');\n                            }\n                            setIconStatus(icon, Selectors.statuses.saved);\n                        });\n                    };\n                    // Error Mesage\n                    const errorMessage = (error) => {\n                        editor.classList.add(\"local-coursetranslator__error\");\n                        setIconStatus(icon, Selectors.statuses.failed);\n                        if (error) {\n                            textarea.innerHTML = error;\n                        }\n                    };\n\n                    // Submit the request\n                    ajax.call([\n                        {\n                            methodname: \"local_coursetranslator_update_translation\",\n                            args: {\n                                data: [tdata],\n                            },\n                            done: (data) => {\n                                // Print response to console log\n                                if (config.debug > 0) {\n                                    window.console.info(\"ws: \", key, data);\n                                }\n\n                                // Display success message\n                                if (data.length > 0) {\n                                    successMessage();\n                                    textarea.innerHTML = data[0].text;\n\n                                    // Update source lang if necessary\n                                    if (config.currentlang === config.lang) {\n                                        document.querySelector(Selectors.sourcetexts.keys.replace('<KEY>', key))\n                                            .innerHTML = text;\n                                    }\n                                } else {\n                                    // Something went wrong with the data\n                                    errorMessage();\n                                }\n                            },\n                            fail: (error) => {\n                                // An error occurred\n                                errorMessage(error);\n                            },\n                        },\n                    ]);\n                } else {\n                    // Something went wrong with field retrieval\n                    window.console.warn(data);\n                }\n            },\n            fail: (error) => {\n                // An error occurred\n                window.console.warn(error);\n            },\n        },\n    ]);\n};\n\n/**\n * Update Textarea\n * @param {string} fieldtext Latest text from database\n * @param {string} text Text to update\n * @param {string} source Original text translated from\n * @returns {string}\n */\nconst getupdatedtext = (fieldtext, text, source) => {\n    let targetlang = targetLang;\n    // Search for {mlang} not found.\n    let startOther = `{mlang other}`;\n    let otherlangtext = `${startOther}${source}{mlang}`; // Source tag.\n    let targetLangTag = `{mlang ${targetlang}}`; // Target tag.\n    let targetlangtext = `${targetLangTag}${text}{mlang}`;\n    if (config.debug > 0) {\n        window.console.info(\"targetlang\", targetlang);\n        window.console.info(\"startOther\", startOther);\n        window.console.info(\"otherlangtext\", otherlangtext);\n        window.console.info(\"targetLangTag\", targetLangTag);\n        window.console.info(\"targetlangtext\", targetlangtext); // Translated text with tag.\n        window.console.info(\"fieldtext\", fieldtext); // Original editor content.\n        window.console.info(\"text\", text); // Translated text without tag.\n        window.console.info(\"source\", source); // Source text without tag.\n    }\n    // Return new mlang text if mlang has not been used before.\n    if (fieldtext.indexOf(\"{mlang\") === -1) {\n        return otherlangtext + targetlangtext;\n    }\n    // Use regex to replace the string.\n    let alllanpattern = `({mlang [a-z]{2,5}})(.*?){mlang}`;\n    // Important to leave the \"s\" mofifiers to match line breaks added by the rich text editors.\n    let alllangregex = new RegExp(alllanpattern, \"gs\");\n    let all = {};\n    let tagReg = new RegExp(\"{mlang (other|[a-z]{2})}\", \"\");\n    let splited = fieldtext.split(alllangregex);\n    if (config.debug > 0) {\n        window.console.info(\"SPLITED\", splited);\n    }\n    let foundsourcetag = \"\";\n    var l = \"\";\n    for (var i in splited) {\n        if (splited[i] === \"\") {\n            continue;\n        }\n        if (splited[i].match(tagReg)) {\n            l = splited[i].match(tagReg)[0];\n        } else if (l !== \"\") {\n            all[l] = splited[i];\n            if (splited[i] === source) {\n                foundsourcetag = l;\n            }\n            l = \"\";\n        }\n    }\n    if (foundsourcetag !== startOther) {\n        // We need to replace the source.\n        delete all[foundsourcetag];\n    }\n    // If there is a other tag we replace it by the source.\n    // @todo a mechanism to propose to the user to select another tag for this.\n    all[startOther] = source;\n    all[targetLangTag] = text;\n    let s = \"\";\n    for (let tag in all) {\n        s += tag + all[tag] + \"{mlang}\";\n    }\n    return s;\n};\nconst onItemChecked = (e) => {\n    toggleStatus(e.target.getAttribute('data-key'), e.target.checked);\n    countWordAndChar();\n};\nconst toggleStatus = (key, checked) => {\n    const icon = document.querySelector(replaceKey(Selectors.actions.validatorBtn, key));\n    const status = icon.dataset.status;\n    switch (status) {\n        case Selectors.statuses.wait :\n            if (checked) {\n                setIconStatus(icon, Selectors.statuses.totranslate);\n            }\n            break;\n        case Selectors.statuses.totranslate :\n            if (checked && tempTranslations[key]?.translation?.length > 0) {\n                setIconStatus(icon, Selectors.statuses.tosave, true);\n            } else {\n                setIconStatus(icon, Selectors.statuses.wait);\n            }\n            break;\n        case Selectors.statuses.tosave :\n            if (!checked) {\n                setIconStatus(icon, Selectors.statuses.totranslate);\n            }\n            break;\n        case Selectors.statuses.failed :\n            break;\n        case Selectors.statuses.success :\n            break;\n        case Selectors.statuses.saved :\n            break;\n    }\n};\nconst setIconStatus = (icon, s = Selectors.statuses.wait, isBtn = false) => {\n    if (isBtn) {\n        if (!icon.classList.contains('btn')) {\n            icon.classList.add('btn');\n        }\n        if (icon.classList.contains('disable')) {\n            icon.classList.remove('disable');\n        }\n    } else {\n        if (!icon.classList.contains('disable')) {\n            icon.classList.add('disable');\n        }\n        if (icon.classList.contains('btn')) {\n            icon.classList.remove('btn');\n        }\n    }\n    icon.setAttribute('role', isBtn ? 'button' : 'status');\n    icon.setAttribute('data-status', s);\n};\n/**\n * Shows/hides rows\n * @param {string} selector\n * @param {boolean} selected\n */\nconst showRows = (selector, selected) => {\n    const items = document.querySelectorAll(selector);\n    const allSelected = document.querySelector(Selectors.actions.selectAllBtn).checked;\n    window.console.log(allSelected);\n    items.forEach((item) => {\n        let k = item.getAttribute('data-row-id');\n        toggleRowVisibility(item, selected);\n        // When a row is toggled then we don't want it to be selected and sent from translation.\n        item.querySelector(replaceKey(Selectors.editors.multiples.checkBoxesWithKey, k)).checked = allSelected && selected;\n        //toggleStatus(k, false);\n        toggleStatus(k, false);\n    });\n    toggleAutotranslateButton();\n    countWordAndChar();\n};\nconst toggleRowVisibility = (row, checked) => {\n    if (checked) {\n        row.classList.remove(\"d-none\");\n    } else {\n        row.classList.add(\"d-none\");\n    }\n};\n/**\n * Event listener to switch target lang\n * @param {Event} e\n */\nconst switchTarget = (e) => {\n    let url = new URL(window.location.href);\n    let searchParams = url.searchParams;\n    searchParams.set(\"target_lang\", e.target.value);\n    window.location = url.toString();\n};\n/**\n * Event listener to switch source lang\n * Hence reload the page and change the site main lang\n * @param {Event} e\n */\nconst switchSource = (e) => {\n    let url = new URL(window.location.href);\n    let searchParams = url.searchParams;\n    searchParams.set(\"lang\", e.target.value);\n    window.location = url.toString();\n};\n/**\n * Launch autotranslation\n */\nconst doAutotranslate = () => {\n    saveAllBtn.hidden = saveAllBtn.disabled = false;\n\n    document\n        .querySelectorAll(Selectors.statuses.checkedCheckBoxes)\n        .forEach((ckBox) => {\n            let key = ckBox.getAttribute(\"data-key\");\n            getTranslation(key);\n        });\n};\n/**\n * @todo extract images ALT tags to send for translation\n * Send for Translation to DeepL\n * @param {Integer} key Translation Key\n */\nconst getTranslation = (key) => {\n    // Store the key in the dictionary\n    tempTranslations[key] = {};\n    // Get the editor\n    let editorSettings = findEditor(key);\n    if (config.debug > 0) {\n        window.console.info(editorSettings);\n    }\n    let editor = editorSettings.editor;\n    let editorType = editorSettings.editorType;\n\n    // Get the source text\n    let sourceText = document.querySelector(Selectors.sourcetexts.keys.replace(\"<KEY>\", key)).getAttribute(\"data-sourcetext-raw\");\n    let icon = document.querySelector(replaceKey(Selectors.actions.validatorBtn, key));\n    // Initialize global dictionary with this key's editor.\n    tempTranslations[key] = {\n        'editorType': editorType,\n        'editor': editor,\n        'source': sourceText,\n        'status': Selectors.statuses.wait,\n        'translation': ''\n    };\n    // Build formData\n    let formData = new FormData();\n    formData.append(\"text\", sourceText);\n    formData.append(\"source_lang\", sourceLang.toUpperCase());\n    formData.append(\"target_lang\", targetLang.toUpperCase());\n    formData.append(\"auth_key\", config.apikey);\n    formData.append(\"tag_handling\", document.querySelector(Selectors.deepl.tagHandling).checked ? 'html' : 'xml');//\n    formData.append(\"context\", document.querySelector(Selectors.deepl.context).value ?? null); //\n    formData.append(\"split_sentences\", document.querySelector(Selectors.deepl.splitSentences).value);//\n    formData.append(\"preserve_formatting\", document.querySelector(Selectors.deepl.preserveFormatting).checked);//\n    formData.append(\"formality\", document.querySelector('[name=\"local-coursetranslator/formality\"]:checked').value);\n    formData.append(\"glossary_id\", document.querySelector(Selectors.deepl.glossaryId).value);//\n    formData.append(\"outline_detection\", document.querySelector(Selectors.deepl.outlineDetection).checked);//\n    formData.append(\"non_splitting_tags\", toJsonArray(document.querySelector(Selectors.deepl.nonSplittingTags).value));\n    formData.append(\"splitting_tags\", toJsonArray(document.querySelector(Selectors.deepl.splittingTags).value));\n    formData.append(\"ignore_tags\", toJsonArray(document.querySelector(Selectors.deepl.ignoreTags).value));\n    if (config.debug) {\n        window.console.info(\"Send deepl:\", formData);\n    }\n    // Update the translation\n    let xhr = new XMLHttpRequest();\n    xhr.onreadystatechange = () => {\n        if (xhr.readyState === XMLHttpRequest.DONE) {\n            const status = xhr.status;\n            if (status === 0 || (status >= 200 && status < 400)) {\n                // The request has been completed successfully\n                let data = JSON.parse(xhr.responseText);\n                // Display translation\n                editor.innerHTML = data.translations[0].text;\n                // Store the translation in the global object\n                tempTranslations[key].translation = data.translations[0].text;\n                setIconStatus(icon, Selectors.statuses.tosave, true);\n                injectImageCss(editorSettings); // Hack for iframes based editors to highlight missing pictures.\n            } else {\n                // Oh no! There has been an error with the request!\n                setIconStatus(icon, Selectors.statuses.failed, false);\n            }\n        }\n    };\n    xhr.open(\"POST\", config.deeplurl);\n    xhr.send(formData);\n};\n/**\n * Inject css to highlight ALT text of image not loaded because of @@POLUGINFILE@@\n * @param {Integer} editorSettings\n * */\nconst injectImageCss = (editorSettings) => {\n    // Prepare css to inject in iframe editors\n    const css = document.createElement('style');\n    css.textContent = 'img{background-color:yellow !important;font-style: italic;}';\n    if (editorSettings.editorType === \"iframe\") {\n        let editorschildrens = Array.from(editorSettings.editor.parentElement.children);\n        let found = false;\n        for (let j in editorschildrens) {\n            let e = editorschildrens[j];\n            if (e.innerText === css.innerText) {\n                found = true;\n                break;\n            }\n        }\n        if (!found) {\n            editorSettings.editor.parentElement.appendChild(css);\n        }\n    }\n};\n/**\n * Get the editor container based on recieved current user's\n * editor preference.\n * @param {Integer} key Translation Key\n */\nconst findEditor = (key) => {\n    let e = document.querySelector(Selectors.editors.types.basic\n        .replace(\"<KEY>\", key));\n    let et = 'basic';\n    if (e === null) {\n        switch (mainEditorType) {\n            case \"atto\" :\n                et = 'iframe';\n                e = document.querySelector(\n                    Selectors.editors.types.atto\n                        .replaceAll(\"<KEY>\", key));\n                break;\n            case \"tiny\":\n                et = 'iframe';\n                e = document.querySelector(Selectors.editors.types.tiny\n                    .replaceAll(\"<KEY>\", key))\n                    .contentWindow.tinymce;\n                break;\n            case 'marklar':\n            case \"textarea\" :\n                e = document.querySelector(Selectors.editors.types.other\n                    .replaceAll(\"<KEY>\", key));\n                break;\n        }\n    }\n    return {editor: e, editorType: et};\n};\n/**\n * Toggle checkboxes\n * @param {Event} e Event\n */\nconst toggleAllCheckboxes = (e) => {\n    // Check/uncheck checkboxes\n    if (e.target.checked) {\n        checkboxes.forEach((i) => {\n            // Toggle check box upon visibility\n            i.checked = !getParentRow(i).classList.contains('d-none');\n            toggleStatus(i.getAttribute('data-key'), i.checked);\n        });\n    } else {\n        checkboxes.forEach((i) => {\n            i.checked = false;\n            toggleStatus(i.getAttribute('data-key'), false);\n        });\n    }\n    toggleAutotranslateButton();\n    countWordAndChar();\n};\nconst getParentRow = (node) => {\n    return node.closest(replaceKey(Selectors.sourcetexts.parentrow, node.getAttribute('data-key')));\n};\n/**\n * Toggle Autotranslate Button\n */\nconst toggleAutotranslateButton = () => {\n    autotranslateButton.disabled = true;\n    for (let i in checkboxes) {\n        let e = checkboxes[i];\n        if (e.checked) {\n            autotranslateButton.disabled = false;\n            break;\n        }\n    }\n};\n/**\n * Multilang button handler\n * @param {Event} e Event\n */\nconst onToggleMultilang = (e) => {\n    e.classList.toggle(\"showing\");\n    let keyid = e.getAttribute('aria-controls');\n    let key = keyidToKey(keyid);\n    let source = document.querySelector(replaceKey(Selectors.sourcetexts.keys, key));\n    let multilang = document.querySelector(replaceKey(Selectors.sourcetexts.multilangs, keyid));\n    source.classList.toggle(\"show\");\n    multilang.classList.toggle(\"show\");\n};\n/**\n * Json helper\n * @param {string} s\n * @param {string} sep\n * @returns {string}\n */\nconst toJsonArray = (s, sep = \",\") => {\n    return JSON.stringify(s.split(sep));\n};\n/**\n * Simple helper to manage selectors\n * @param {string} s\n * @param {string} k\n * @returns {*}\n */\nconst replaceKey = (s, k) => {\n    return s.replace(\"<KEY>\", k);\n};\n/**\n * Transforms a keyid to a key\n * @param {string} k\n * @returns {`${*}[${*}][${*}]`}\n */\nconst keyidToKey = (k) => {\n    let m = k.match(/^(.+)-(.+)-(.+)$/i);\n    return `${m[1]}[${m[2]}][${m[3]}]`;\n};\n/**\n * Launch countWordAndChar\n */\nconst countWordAndChar = () => {\n    let wc = 0;\n    let sc = 0;\n    let csc = 0;\n    document\n        .querySelectorAll(Selectors.statuses.checkedCheckBoxes)\n        .forEach((ckBox) => {\n            let key = ckBox.getAttribute(\"data-key\");\n            let results = getCount(key);\n            wc += results.wordCount;\n            csc += results.charNumWithOutSpace;\n            sc += results.charNumWithSpace;\n        });\n    let wcSpan = document.querySelector(Selectors.statuses.wordcount);\n    let scSpan = document.querySelector(Selectors.statuses.charNumWithSpace);\n    let cscSpan = document.querySelector(Selectors.statuses.charNumWithOutSpace);\n    window.console.log(wcSpan, scSpan, cscSpan);\n    window.console.log(wcSpan.text, scSpan.text, cscSpan.text);\n    window.console.log(wc, sc, csc);\n    wcSpan.innerText = wc;\n    scSpan.innerText = sc;\n    cscSpan.innerText = csc;\n};\n/**\n * @param {string} key\n * @return {object}\n */\nconst getCount = (key) => {\n    let sourceText = document.querySelector(Selectors.sourcetexts.keys.replace(\"<KEY>\", key)).getAttribute(\"data-sourcetext-raw\");\n    return countChars(sourceText);\n};\n/**\n *\n * @param {String} val\n * @returns {{wordCount: *, charNumWithSpace: *, charNumWithOutSpace: *}}\n */\nconst countChars = (val) => {\n    const withSpace = val.length;\n    // Without using regex\n    //var withOutSpace = document.getElementById(\"newInputID\").value.split(' ').join('').length;\n    //with using Regex\n    const withOutSpace = val.replace(/\\s+/g, '').length;\n    const wordsCount = val.match(/\\S+/g).length;\n    window.console.log({\n        \"wordCount\": wordsCount,\n        \"charNumWithSpace\": withSpace,\n        \"charNumWithOutSpace\": withOutSpace\n    });\n    return {\n        \"wordCount\": wordsCount,\n        \"charNumWithSpace\": withSpace,\n        \"charNumWithOutSpace\": withOutSpace\n    };\n};\n"],"names":["tempTranslations","mainEditorType","config","autotranslateButton","checkboxes","sourceLang","targetLang","saveAllBtn","usage","cfg","debug","window","console","info","userPrefs","document","querySelector","Selectors","actions","saveAll","sourceSwitcher","value","targetSwitcher","autoTranslateBtn","querySelectorAll","checkBoxes","forEach","node","dataset","key","e","error","message","registerUI","addEventListener","target","closest","switchTarget","switchSource","showUpdated","showRows","statuses","updated","checked","showNeedUpdate","needsupdate","onItemChecked","toggleMultilang","onToggleMultilang","currentlang","lang","undefined","create","title","body","show","removeOnClose","doAutotranslate","selectAllBtn","toggleAllCheckboxes","checkedCheckBoxes","translation","saveTranslation","warn","toggleAutotranslateButton","disabled","validatorsBtns","item","keyValidator","editor","text","innerHTML","sourceText","source","icon","replaceKey","validatorBtn","selector","editors","multiples","editorsWithKey","replace","element","id","getAttribute","tid","table","field","fielddata","courseid","parseInt","call","methodname","args","data","done","fieldtext","length","textarea","textAreas","updatedtext","getupdatedtext","tdata","successMessage","classList","add","setIconStatus","success","setTimeout","multilangPill","multilang","prevTransStatus","contains","remove","saved","errorMessage","failed","sourcetexts","keys","fail","targetlang","otherlangtext","targetLangTag","targetlangtext","indexOf","alllangregex","RegExp","all","tagReg","splited","split","foundsourcetag","l","i","match","s","tag","toggleStatus","countWordAndChar","status","wait","totranslate","tosave","isBtn","setAttribute","selected","items","allSelected","log","k","toggleRowVisibility","checkBoxesWithKey","row","url","URL","location","href","searchParams","set","toString","hidden","ckBox","getTranslation","editorSettings","findEditor","editorType","formData","FormData","append","toUpperCase","apikey","deepl","tagHandling","context","splitSentences","preserveFormatting","glossaryId","outlineDetection","toJsonArray","nonSplittingTags","splittingTags","ignoreTags","xhr","XMLHttpRequest","onreadystatechange","readyState","DONE","JSON","parse","responseText","translations","injectImageCss","open","deeplurl","send","css","createElement","textContent","editorschildrens","Array","from","parentElement","children","found","j","innerText","appendChild","types","basic","et","atto","replaceAll","tiny","contentWindow","tinymce","other","getParentRow","parentrow","toggle","keyid","keyidToKey","multilangs","sep","stringify","m","wc","sc","csc","results","getCount","wordCount","charNumWithOutSpace","charNumWithSpace","wcSpan","wordcount","scSpan","cscSpan","countChars","val","withSpace","withOutSpace","wordsCount"],"mappings":"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"}